<div class="container-fluid mt-5">
  <div class="row" *ngIf="productsArr.length > 0; else noProducts">
    <div class="col-sm-3 mb-5" *ngFor="let prod of productsArr">
      <div
        class="card h-100 border-0 prodCard"
        style="cursor: pointer; transition: all 0.6s ease-in-out"
        (mouseenter)="hoveredProductId = prod._id"
        (mouseleave)="hoveredProductId = null"
        [routerLink]="prod._id"
      >
        <div class="prodImg">
          <img
            [src]="prod.images[0]"
            [ngClass]="{
              'main-img': true,
              hide: hoveredProductId === prod._id
            }"
            alt="Product"
          />
          <img
            [src]="prod.images[1]"
            [ngClass]="{
              'hover-img': true,
              show: hoveredProductId === prod._id
            }"
            alt="Product Hover"
          />
          <div class="discount-badge">{{ prod.discount }}% OFF</div>
          <div class="hoverIcons">
            <button
              mat-mini-fab
              matTooltip="View details"
              matTooltipPosition="left"
            >
              <mat-icon>visibility</mat-icon>
            </button>
            <button
              mat-mini-fab
              matTooltip="Add favorite"
              matTooltipPosition="left"
            >
              <mat-icon>favorite</mat-icon>
            </button>
          </div>
          <div
            class="btn-block"
            [ngClass]="{ show: hoveredProductId === prod._id }"
          >
            <button class="btn">Add to Cart</button>
          </div>
        </div>
        <div class="card-body prodInfo">
          <h6 class="card-subtitle text-secondary text-right">
            {{ prod.subcategory }}
          </h6>
          <h5 class="card-title">
            <strong>{{ prod.title }}</strong>
          </h5>
          <h6 class="card-text text-danger">
            {{
              +prod.total_price.replace("$", "") -
                (+prod.total_price.replace("$", "") * prod.discount) / 100
                | currency : "USD" : "symbol"
            }}
            <small class="text-muted ml-5">{{ prod.total_price }}</small>
          </h6>
          <div class="ratviews d-flex align-items-center mb-4">
            <div class="rating">
              <ng-container *ngFor="let star of stars; let i = index">
                <div class="starGroup">
                  <mat-icon class="star unfilled">star</mat-icon>
                  <mat-icon
                    class="star filled"
                    [ngStyle]="{ width: getStarFill(i, prod.rating) }"
                  >
                    star
                  </mat-icon>
                </div>
              </ng-container>
            </div>
            <small class="text-muted m-0" style="font-weight: 600;">
              ({{ prod.reviews_count }})
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>
  <ng-template #noProducts>
    <p *ngIf="!loading" class="alert alert-info">
      No Products Available Currently
    </p>
  </ng-template>
  <!-- <div class="d-flex justify-content-center align-items-center" *ngIf="loading">
    <mat-spinner color="accent"></mat-spinner>
  </div> -->
</div>
